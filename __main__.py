import sys
from trainer.classifier_trainer import ClassifierTrainer



def get_args_dict(args):
    args_dict = {}
    for arg in args:
        arg_list = arg.split("=")
        key = arg_list[0].replace("--", "")
        args_dict[key] = arg_list[1]
    return args_dict



def assert_args(args_dict):
    assert(args_dict["dataset_name"] != None)
    assert(args_dict["model_checkpoint"] != None)
    assert(args_dict["model_name"] != None)
    assert(args_dict["num_epochs"] != None)
    assert(args_dict["mode"] != None)


def main():
    args = sys.argv[1:]
    
    data_files = [
        ".\\db\\ember2018_train_1.jsonl",
        ".\\db\\ember2018_test_1.jsonl"
    ]
    dataset_name = None
    model_checkpoint = None
    model_name = None
    num_epochs = None
    mode = None


    args_dict = get_args_dict(args)
    dataset_name = args_dict["dataset_name"]
    model_checkpoint = args_dict["model_checkpoint"]
    model_name = args_dict["model_name"]

    try:
        num_epochs = int(args_dict["num_epochs"])
    except:
        raise ValueError
    
    mode = args_dict["mode"]
    classifier_trainer = ClassifierTrainer(
        model_checkpoint,
        dataset_name,
        model_name,
        mode,
        num_epochs,
        data_files
    )

    classifier_trainer.train()






if __name__ == "__main__":
    main()