import sys
from trainer.classifier_trainer import ClassifierTrainer




def main():
    args = sys.argv[1:]
    
    data_files = [
        ".\\db\\ember2018_train_1.jsonl",
        ".\\db\\ember2018_test_1.jsonl"
    ]
    
    dataset_name = "cw1521/ember2018-malware"
    model_checkpoint = "allenai/longformer-base-4096"
    model_name = "ma-ember-1"
    num_epochs = 1
    mode = "test"

    classifier_trainer = ClassifierTrainer(
        model_checkpoint,
        dataset_name,
        model_name,
        num_epochs,
        mode,
        data_files
    )

    classifier_trainer.train()



if __name__ == "__main__":
    main()